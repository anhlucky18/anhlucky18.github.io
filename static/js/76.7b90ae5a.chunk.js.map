{"version":3,"sources":["hooks/useIsMountedRef.js","../node_modules/@material-ui/icons/NavigateNext.js","utils/bytesToSize.js","components/FilesDropzone.js","api/schools.js","views/schools/InitNewYear/UploadForm.js","views/schools/InitNewYear/Header.js","views/schools/InitNewYear/index.js"],"names":["useIsMountedRef","isMounted","useRef","useEffect","current","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","bytesToSize","bytes","decimals","k","dm","sizes","i","Math","floor","log","parseFloat","pow","toFixed","useStyles","makeStyles","theme","root","dropZone","border","palette","divider","padding","spacing","outline","display","justifyContent","flexWrap","alignItems","backgroundColor","action","hover","opacity","cursor","dragActive","active","image","width","info","marginTop","list","maxHeight","actions","marginLeft","FilesDropzone","className","handleDrop","files","handleRemoveAll","rest","classes","useDropzone","onDrop","getRootProps","getInputProps","isDragActive","clsx","alt","src","Typography","gutterBottom","variant","Box","mt","color","Link","underline","length","options","suppressScrollX","List","map","file","ListItem","ListItemIcon","ListItemText","primary","name","primaryTypographyProps","secondary","size","Tooltip","title","IconButton","edge","Button","onClick","addSchool","data","a","app","firestore","collection","doc","id","docRef","total_student","total_teacher","lms_url","trim","get","exists","console","set","getSchoolApi","querySnapshot","school","updateSchool","update","result","listAllSchool","docs","has_running_command","school_id","where","commands","uploadExcel","user","year","reader","FileReader","rABS","readAsBinaryString","onabort","onerror","onload","e","bstr","target","workbook","XLSX","read","type","command","status","executer","Sheets","keys","sheet0_list","SheetNames","sheet0","utils","sheet_to_json","raw","dateNF","header","blankrows","defval","hs","JSON","stringify","sheet1_list","sheet1","gv","template","add","schoolApi","commandid","url","API_URL","axios","post","then","resp","readAsArrayBuffer","UploadForm","history","useHistory","localStorage","getItem","useState","setCommand","isMountedRef","getCommand","useCallback","error","setFiles","useAuth","acceptedFiles","prevFiles","enqueueSnackbar","useSnackbar","c","initialValues","submit","onSubmit","values","resetForm","setErrors","setStatus","setSubmitting","fetch","res","json","firstname","lastname","userid","userId","created_at","Date","getTime","resultUp","wait","success","push","err","message","errors","handleBlur","handleChange","handleSubmit","isSubmitting","touched","Card","CardContent","disabled","Header","Breadcrumbs","separator","fontSize","to","component","RouterLink","background","dark","minHeight","paddingTop","paddingBottom","InitView","Page","Container","maxWidth"],"mappings":"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","file":"static/js/76.7b90ae5a.chunk.js","sourcesContent":["import {useRef, useEffect } from 'react';\n\nconst useIsMountedRef = () => {\n  const isMounted = useRef(true);\n\n  useEffect(() => () => {\n    isMounted.current = false;\n  }, []);\n\n  return isMounted;\n};\n\nexport default useIsMountedRef;\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\"\n}), 'NavigateNext');\n\nexports.default = _default;","/* eslint-disable no-restricted-properties */\nconst bytesToSize = (bytes, decimals = 2) => {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const dm = decimals < 0 ? 0 : decimals;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;\n};\n\nexport default bytesToSize;\n","import React, {\n  useState,\n  useCallback\n} from 'react';\nimport clsx from 'clsx';\nimport { useDropzone } from 'react-dropzone';\nimport PerfectScrollbar from 'react-perfect-scrollbar';\nimport PropTypes from 'prop-types';\nimport {\n  Box,\n  Button,\n  IconButton,\n  Link,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Tooltip,\n  Typography,\n  makeStyles\n} from '@material-ui/core';\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\nimport MoreIcon from '@material-ui/icons/MoreVert';\nimport bytesToSize from 'src/utils/bytesToSize';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {},\n  dropZone: {\n    border: `1px dashed ${theme.palette.divider}`,\n    padding: theme.spacing(6),\n    outline: 'none',\n    display: 'flex',\n    justifyContent: 'center',\n    flexWrap: 'wrap',\n    alignItems: 'center',\n    '&:hover': {\n      backgroundColor: theme.palette.action.hover,\n      opacity: 0.5,\n      cursor: 'pointer'\n    }\n  },\n  dragActive: {\n    backgroundColor: theme.palette.action.active,\n    opacity: 0.5\n  },\n  image: {\n    width: 130\n  },\n  info: {\n    marginTop: theme.spacing(1)\n  },\n  list: {\n    maxHeight: 320\n  },\n  actions: {\n    marginTop: theme.spacing(2),\n    display: 'flex',\n    justifyContent: 'flex-end',\n    '& > * + *': {\n      marginLeft: theme.spacing(2)\n    }\n  }\n}));\n\nconst FilesDropzone = ({ className,handleDrop,files,handleRemoveAll, ...rest }) => {\n  const classes = useStyles();\n  // const [files, setFiles] = useState([]);\n\n  // const handleDrop = useCallback((acceptedFiles) => {\n  //   setFiles((prevFiles) => [...prevFiles].concat(acceptedFiles));\n  //   console.log(\"con\");\n  // }, []);\n\n  // const handleRemoveAll = () => {\n  //   setFiles([]);\n  // };\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop: handleDrop\n  });\n\n  return (\n    <div\n      className={clsx(classes.root, className)}\n      {...rest}\n    >\n      <div\n        className={clsx({\n          [classes.dropZone]: true,\n          [classes.dragActive]: isDragActive\n        })}\n        {...getRootProps()}\n      >\n        <input {...getInputProps()} />\n        <div>\n          <img\n            alt=\"Select file\"\n            className={classes.image}\n            src=\"/static/images/undraw_add_file2_gvbb.svg\"\n          />\n        </div>\n        <div>\n          <Typography\n            gutterBottom\n            variant=\"h3\"\n          >\n           Tải file lên\n          </Typography>\n          <Box mt={2}>\n            <Typography\n              color=\"textPrimary\"\n              variant=\"body1\"\n            >\n              Bằng cách kéo thả hoặc click \n              {' '}\n              <Link underline=\"always\">vào đây</Link>\n              {' '}\n              để chọn file trên máy của bạn\n            </Typography>\n          </Box>\n        </div>\n      </div>\n      {files.length > 0 && (\n        <>\n          <PerfectScrollbar options={{ suppressScrollX: true }}>\n            <List className={classes.list}>\n              {files.map((file, i) => (\n                <ListItem\n                  divider={i < files.length - 1}\n                  key={i}\n                >\n                  <ListItemIcon>\n                    <FileCopyIcon />\n                  </ListItemIcon>\n                  <ListItemText\n                    primary={file.name}\n                    primaryTypographyProps={{ variant: 'h5' }}\n                    secondary={bytesToSize(file.size)}\n                  />\n                  <Tooltip title=\"More options\">\n                    <IconButton edge=\"end\">\n                      <MoreIcon />\n                    </IconButton>\n                  </Tooltip>\n                </ListItem>\n              ))}\n            </List>\n          </PerfectScrollbar>\n          <div className={classes.actions}>\n            <Button\n              onClick={handleRemoveAll}\n              size=\"small\"\n            >\n              Remove all\n            </Button>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n\nFilesDropzone.propTypes = {\n  className: PropTypes.string\n};\n\nexport default FilesDropzone;\n","import app from './_firebase';\n\nimport axios from 'axios';\nimport XLSX from 'xlsx' ;\nimport { API_URL } from '../config';\n\nexport const addSchool = async (data) => {\n    try {\n        var docRef = await app.firestore().collection(\"schools\").doc(data.id);\n        data.total_student=0;\n        data.total_teacher=0;\n        data.lms_url=data.id.trim()+\".dschool.vn\";\n        const doc = docRef.get()\n        if (doc.exists) {\n            console.log(\"doc exist\")\n            return \"existed\";\n        } else {\n            console.log(data);\n            let school  = await app.firestore().collection('schools').doc(data.id).set(data);\n            console.log(\"add school success\");\n        }\n        \n    } catch (err) {\n        console.log(err);\n    }\n};\n\nexport const getSchoolApi = async (id) => {\n    try {\n        let querySnapshot  = await app.firestore().collection('schools').doc(id).get();\n        const school = querySnapshot.data()\n        school.id=id\n          return school\n    } catch (err) {\n        console.log(err);\n    }\n}\n\nexport const updateSchool = async (data) => {\n    try {\n        let id=data.id;\n        let result  = await app.firestore().collection('schools').doc(id).update(data);\n        return result\n    } catch (err) {\n        console.log(err);\n    }\n};\n\nexport const listAllSchool = async (data) => {\n    try {\n        let querySnapshot  = await app.firestore().collection('schools').get();\n        const school = querySnapshot.docs.map((doc) => {\n            return { id: doc.id, ...doc.data() }\n          })\n          return school\n    } catch (err) {\n        console.log(err);\n    }\n}\n\nexport const has_running_command = async (school_id) => {\n    try {\n       \n        let querySnapshot = await app.firestore().collection('commands').where(\"data.school_id\",\"==\",school_id).where(\"type\",\"==\",\"school\").where(\"action\",\"==\",\"upload\").where(\"status\",\"==\",1).get();\n        const commands = querySnapshot.docs.map((doc) => {\n            return {\n              id: doc.id,\n              ...doc.data()\n            };\n          });\n          console.log(commands);\n          return commands;\n        \n      } catch (err) {\n        console.log(err);\n      }\n}\n\nexport const deleteSchools = (ids) => {\n    try {\n      ids.map((id) => {\n        app.firestore().collection('schools').doc(id).delete();\n      })\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  export const uploadExcel = async (user,file,school_id) => {\n    try {\n        let data = {\"school_id\":school_id};\n        data.year=\"2021_2022\";\n        const reader = new FileReader() \n        const rABS = !!reader.readAsBinaryString;  // !! converts object to boolean \n        reader.onabort = () => console.log('file reading was aborted')\n        reader.onerror = () => console.log('file reading has failed')\n        reader.onload = async(e) => {\n            // Do what you want with the file contents \n            var bstr = e.target.result; \n            var workbook = XLSX.read(bstr, { type: rABS ? \"binary\" : \"array\" })\n            var command = {\n              type: \"school\",\n              action: \"upload\",\n              status: 0,\n              executer: user,\n            }\n            console.log(workbook.Sheets);\n            let length=Object.keys( workbook.Sheets).length;\n            console.log(\"length\",length)\n            if(length==2){\n              //issert mẫu mới \n              var sheet0_list = workbook.SheetNames[0];\n              var sheet0 = XLSX.utils.sheet_to_json(workbook.Sheets[sheet0_list], {\n                  raw: false,\n                  dateNF: \"MM-DD-YYYY\",\n                  header:1,\n                  blankrows: false,\n                  defval: \"\"\n              })\n              data.hs = JSON.stringify(sheet0);\n              var sheet1_list = workbook.SheetNames[1];\n              var sheet1 = XLSX.utils.sheet_to_json(workbook.Sheets[sheet1_list], {\n                  raw: false,\n                  dateNF: \"MM-DD-YYYY\",\n                  header:1,\n                  blankrows: false,\n                  defval: \"\"\n              })\n              // const checkhs = check_hs(data.hs)\n              // if(checkhs){\n              //   console.log(\"checkhs\",checkhs)\n              //   return checkhs;\n              // }\n              data.gv = JSON.stringify(sheet1);\n              data.template=2;\n              command.data=data;\n              // const checkgv = check_gv(data.gv);\n              // if(checkgv){\n              //   console.log(\"checkgv\",checkgv)\n              //   return checkgv;\n              // }\n            } else if(length==3){\n              console.log(\"not use 3 temp\")\n              return \"please review template\";\n              //insert mẫu cũ \n              // var sheet0_list = workbook.SheetNames[0];\n              // var sheet0 = XLSX.utils.sheet_to_json(workbook.Sheets[sheet0_list], {\n              //     raw: false,\n              //     dateNF: \"MM-DD-YYYY\",\n              //     header:1,\n              //     blankrows: false,\n              //     defval: \"\"\n              // })\n              // data.hs = JSON.stringify(sheet0);\n              // var sheet1_list = workbook.SheetNames[1];\n              // var sheet1 = XLSX.utils.sheet_to_json(workbook.Sheets[sheet1_list], {\n              //     raw: false,\n              //     dateNF: \"MM-DD-YYYY\",\n              //     header:1,\n              //     blankrows: false,\n              //     defval: \"\"\n              // })\n              // data.gv = JSON.stringify(sheet1);\n              // var sheet2_list = workbook.SheetNames[2];\n              // var sheet2 = XLSX.utils.sheet_to_json(workbook.Sheets[sheet2_list], {\n              //     raw: false,\n              //     dateNF: \"MM-DD-YYYY\",\n              //     header:1,\n              //     blankrows: false,\n              //     defval: \"\"                \n              // })\n              // data.assignment = JSON.stringify(sheet2);\n              // data.template=3;\n              // command.data=data;\n            }\n\n            \n\n            let schoolApi = await app.firestore().collection('commands').add(command);\n            let id = await (await schoolApi.get()).id;\n            console.log(id)\n            command.data.commandid=id;\n            const url = `${API_URL}/api/upload_school`;\n            axios.post(url,{id:id}).then(resp => {\n                console.log(resp.data);\n            });\n            // console.log(\"add command success\",id)\n            return \"success\";\n          }\n          if (rABS) {await reader.readAsBinaryString(file);}\n          else {await reader.readAsArrayBuffer(file);}\n    } catch (err) {\n      console.log(err);\n      return \"Lỗi rồi !!!\";\n    }\n  };\n\n  function check_hs(data){\n    console.log(\"hs:\",data);\n    for (let user_row of data) {\n      if (user_row[0] != \"STT\") {\n        let class_name = user_row[1];\n        let fullname = user_row[3];\n        let birthdate = user_row[4];\n        let password = user_row[8];\n        let username = user_row[7];\n        if(class_name==null||fullname==null||username==null||password==null||class_name==\"\"||fullname==\"\"||username==\"\"||password==\"\"){\n          return \"Xem lại lớp:\"+class_name+\" tên:\"+fullname+\" user:\"+username+\" pass:\"+password;\n        }\n      }\n    }\n    return false;\n  }\n  function check_gv(data){\n    console.log(\"gv:\",data);\n    for (let user_row of data) {\n      if (user_row[0] != \"STT\") {\n\n        let class_name = user_row[1];\n        let fullname = user_row[3];\n        let birthdate = user_row[4];\n        let password = user_row[8];\n        let username = user_row[7];\n        if(class_name==null||fullname==null||username==null||password==null||class_name==\"\"||fullname==\"\"||username==\"\"||password==\"\"){\n          return \"Xem lại lớp:\"+class_name+\" tên:\"+fullname+\" user:\"+username+\" pass:\"+password;\n        }\n      }\n    }\n    return false;\n  }","import React,{\n  useState,useEffect,\n  useCallback} from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport * as Yup from 'yup';\nimport { Formik } from 'formik';\nimport { useSnackbar } from 'notistack';\nimport {\n  Box,\n  Button,\n  Card,\n  CardContent,\n  makeStyles\n} from '@material-ui/core';\nimport wait from 'src/utils/wait';\nimport FilesDropzone from 'src/components/FilesDropzone';\nimport useAuth from 'src/hooks/useAuth';\nimport {uploadExcel,has_running_command} from '../../../api/schools.js';\nimport { useHistory } from 'react-router-dom';\nimport useIsMountedRef from 'src/hooks/useIsMountedRef';\n\nconst useStyles = makeStyles(() => ({\n  root: {}\n}));\n\nconst UploadForm = ({\n  className,\n  ...rest\n}) => {\n  const history = useHistory();\n\n  const school_id = localStorage.getItem('schoolid');\n  //check status\n  const [command, setCommand] = useState(null);\n  \n  const isMountedRef = useIsMountedRef();\n  const getCommand = useCallback(async () => {\n    try {\n      const command = await has_running_command(school_id);\n    console.log(command);\n      if (isMountedRef.current) {\n        setCommand(command);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  }, [isMountedRef]);\n\n  useEffect(() => {\n    getCommand();\n  }, [getCommand]);\n    \n   \n\n  const [files, setFiles] = useState([]);\n  // let school = JSON.parse(localStorage.getItem('school'));\n  const { user} = useAuth();\n  // console.log(school)\n  console.log(user.name)\n  \n  const handleRemoveAll = () => {\n    setFiles([]);\n  };\n  const handleDrop = useCallback((acceptedFiles) => {\n    setFiles((prevFiles) => acceptedFiles);\n  }, []);\n  const classes = useStyles();\n  const { enqueueSnackbar } = useSnackbar();\n  if(command!=null && command.length>0){\n    console.log(command)\n    return (\n      <div>\n        <h1 >Running</h1>\n      {command.map((c) => {\n                \n                return (\n                  <h5 key={c.id}>{c.data.school_id}</h5>\n                );\n              })}\n      </div>\n    );\n\n  } else\n    return (\n    <Formik\n    initialValues={{\n      submit: null\n    }}\n      onSubmit={async (values, {\n        resetForm,\n        setErrors,\n        setStatus,\n        setSubmitting\n      }) => {\n        try {\n          console.log(\"click save\")\n\n          fetch(`https://geolocation-db.com/json/`).then(res=>res.json()).then( async (result)=>{\n            if(typeof(user.name)==\"undefined\"){\n              result.name = user.firstname + \" \" + user.lastname;  \n            } else {\n              result.name=user.name\n            }\n            result.userid=user.userId\n            result.created_at = new Date().getTime();\n            const resultUp = await uploadExcel(result, files[0],school_id);\n            if(resultUp==\"success\"){\n              await wait(500);\n              resetForm();\n              setStatus({ success: true });\n              setSubmitting(false);\n              enqueueSnackbar('Bắt đầu chạy đồng bộ', {\n                variant: 'success',\n                action: <Button>start</Button>\n              });\n              await wait(500);\n              history.push('/school/management/classes');\n            } else {\n              // alert(resultUp);\n              await wait(500);\n              resetForm();\n              setStatus({ success: true });\n              setSubmitting(false);\n              enqueueSnackbar(resultUp, {\n                variant: 'resultUp',\n                action: <Button>start</Button>\n              });\n              await wait(500);\n              history.push('/school/management/classes');\n              \n            }\n          });\n          \n          // setSchool(values)\n          // console.log(values)\n          // NOTE: Make API request\n          \n\n        } catch (err) {\n          console.error(err);\n          setStatus({ success: false });\n          setErrors({ submit: err.message });\n          setSubmitting(false);\n        }\n      }}\n    >\n      {({\n        errors,\n        handleBlur,\n        handleChange,\n        handleSubmit,\n        isSubmitting,\n        touched,\n        values\n      }) => (\n        <form\n          className={clsx(classes.root, className)}\n          onSubmit={handleSubmit}\n          {...rest}\n        >\n          <Card>\n            <CardContent>\n            <CardContent>\n              <FilesDropzone handleDrop = {handleDrop} files={files} handleRemoveAll={handleRemoveAll}/>\n            </CardContent>\n              <Box mt={2}>\n                <Button\n                  variant=\"contained\"\n                  color=\"secondary\"\n                  type=\"submit\"\n                  disabled={isSubmitting}\n                >\n                  Lưu\n                </Button>\n              </Box>\n            </CardContent>\n          </Card>\n        </form>\n      )}\n    </Formik>\n  );\n};\n\nUploadForm.propTypes = {\n  className: PropTypes.string\n};\n\nexport default UploadForm;\n","import React from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport {\n  Breadcrumbs,\n  Link,\n  Typography,\n  makeStyles\n} from '@material-ui/core';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\n\nconst useStyles = makeStyles(() => ({\n  root: {}\n}));\n\nconst Header = ({ className, ...rest }) => {\n  const classes = useStyles();\n\n  return (\n    <div\n      className={clsx(classes.root, className)}\n      {...rest}\n    >\n      <Breadcrumbs\n        separator={<NavigateNextIcon fontSize=\"small\" />}\n        aria-label=\"breadcrumb\"\n      >\n        <Link\n          variant=\"body1\"\n          color=\"inherit\"\n          to=\"/hbon/management/schools\"\n          component={RouterLink}\n        >\n          Trang chủ\n        </Link>\n        <Link\n          variant=\"body1\"\n          color=\"inherit\"\n          to=\"/hbon/management/schools\"\n          component={RouterLink}\n        >\n          Trường học\n        </Link>\n      </Breadcrumbs>\n      <Typography\n        variant=\"h3\"\n        color=\"textPrimary\"\n      >\n        Thêm trường học\n      </Typography>\n    </div>\n  );\n};\n\nHeader.propTypes = {\n  className: PropTypes.string\n};\n\nexport default Header;\n","import React from 'react';\nimport {\n  Box,\n  Container,\n  makeStyles\n} from '@material-ui/core';\nimport Page from 'src/components/Page';\nimport UploadForm from './UploadForm';\nimport Header from './Header';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    minHeight: '100%',\n    paddingTop: theme.spacing(3),\n    paddingBottom: theme.spacing(3)\n  }\n}));\n\nconst InitView = () => {\n  const classes = useStyles();\n  console.log(\"creating school\")\n\n\n  return (\n    <Page\n      className={classes.root}\n      title=\"Thêm trường học\"\n    >\n      <Container maxWidth={false}>\n        <Header />\n      </Container>\n      <Box mt={3}>\n        <Container maxWidth=\"lg\">\n          <UploadForm />\n        </Container>\n      </Box>\n    </Page>\n  );\n};\n\nexport default InitView;\n"],"sourceRoot":""}