(this["webpackJsonp@devias-io/material-kit-pro-react"]=this["webpackJsonp@devias-io/material-kit-pro-react"]||[]).push([[11],{1258:function(e,t,o){"use strict";var n=o(0);t.a=function(){var e=Object(n.useRef)(!0);return Object(n.useEffect)((function(){return function(){e.current=!1}}),[]),e}},1364:function(e,t,o){"use strict";o.d(t,"h",(function(){return h})),o.d(t,"a",(function(){return _})),o.d(t,"c",(function(){return E})),o.d(t,"i",(function(){return v})),o.d(t,"f",(function(){return T})),o.d(t,"k",(function(){return k})),o.d(t,"b",(function(){return w})),o.d(t,"g",(function(){return R})),o.d(t,"d",(function(){return S})),o.d(t,"l",(function(){return P})),o.d(t,"j",(function(){return U})),o.d(t,"e",(function(){return m}));var n=o(9),c=o.n(n),a=o(24),s=o(14),r=o(184),i=o.n(r),l=o(53),u=o(1392),d=o.n(u),p=o(1143),f=o(1560),g=o(1367),h=function(){var e=Object(s.a)(c.a.mark((function e(t){var o,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=null,!t){e.next=8;break}return e.next=5,l.a.firestore().collection("schools").doc(t).collection("contents").orderBy("create_at","desc").get();case 5:o=e.sent,e.next=11;break;case 8:return e.next=10,l.a.firestore().collection("contents").orderBy("create_at","desc").get();case 10:o=e.sent;case 11:return n=o.docs.map((function(e){return Object(a.a)({id:e.id},e.data())})),e.abrupt("return",n);case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r,u,d,p,f,g;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=" <news content-type='news'>"+t.detail+"</news>",delete t.detail,t.content_type="news",t.create_at=i.a.firestore.FieldValue.serverTimestamp(),e.next=7,l.a.firestore().collection("contents").add(t);case 7:return a=e.sent,e.next=10,a.get();case 10:if(s=e.sent,console.log("done content:"+s.id),r=s.data(),(u=l.a.storage().ref().child("public/contents/"+s.id).putString(n)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){u.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),a.collection("detail").doc("content").set({data:n,file:"public/contents/"+s.id,content_url:e})}))})),"undefined"!=typeof o){e.next=17;break}return e.abrupt("return");case 17:d={contentType:"image/jpeg"},p="public/images/content/"+s.id,"public/images/content/app"+s.id,f=l.a.storage().ref(),(g=f.child(p).put(o,d)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){g.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),r.cover=e,l.a.firestore().collection("contents").doc(s.id).update(r)}))})),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(t,o){return e.apply(this,arguments)}}(),E=function(e){try{e.map((function(e){var t="public/images/content/"+e,o=l.a.storage().ref();o.child(t).getDownloadURL().then((function(e){o.child(t).delete()}),(function(e){console.log(e.code)})),l.a.firestore().collection("contents").doc(e).collection("detail").doc("content").delete(),l.a.firestore().collection("contents").doc(e).delete()}))}catch(t){console.log(t)}},v=function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t,(function(e,t){return e?(console.log(e),{statusCode:500,message:"G\u1eedi notify th\u1ea5t b\u1ea1i"}):(console.log(t),{statusCode:200,message:"G\u1eedi notify th\xe0nh c\xf4ng"})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function A(e,t){return b.apply(this,arguments)}function b(){return(b=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r,i,u,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=l.a.firestore().collection("contents").doc(t),e.next=4,n.get();case 4:(a=e.sent).exists&&(s=a.data(),(r=s.tags).length>0&&(i=[],r.forEach((function(e,t){r.length>=5?t<5&&(i+=4==t?"'"+e+"' in topics ":"'"+e+"' in topics || "):(console.log(i.length),console.log("topic.length"),t<5&&(t+1==r.length?i+="'"+e+"' in topics ":i+="'"+e+"' in topics || "))})),u={"User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:24.0) Gecko/20100101 Firefox/24.0","Content-Type":"application/json",Authorization:"key="+Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AUTH0_CLIENT_ID:"",REACT_APP_AUTH0_DOMAIN:"",REACT_APP_SERVER_URL:"https://server.dschool.vn",REACT_APP_LOGOUT_URL:"https://id.hocbaionha.com/oauth2/sessions/logout",REACT_APP_H5P_URL:"https://h5p.dschool.vn",REACT_APP_FIREBASE_API_KEY:"AIzaSyD1rFzhNHcbWql0L8g4dWMcdgn5KiZ3cv4",REACT_APP_FIREBASE_APP_ID:"1:666303282505:web:2daabfe2056b8bcf276e98",REACT_APP_FIREBASE_AUTH_DOMAIN:"hbon-sso.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://hbon-sso.firebaseio.com",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"666303282505",REACT_APP_FIREBASE_PROJECT_ID:"hbon-sso",REACT_APP_FIREBASE_STORAGE_BUCKET:"hbon-sso.appspot.com",REACT_APP_GA_MEASUREMENT_ID:"G-6ED668BBJC"}).REACT_APP_FIREBASE_CLOUD_MESSAGE_KEY},p={condition:i,priority:"high",notification:{body:s.title,title:"Hbon news",sound:"default",image:s.cover},apns:{payload:{aps:{"mutable-content":1}},fcm_options:{image:s.cover}},data:{click_action:"FLUTTER_NOTIFICATION_CLICK",deep_link:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_AUTH0_CLIENT_ID:"",REACT_APP_AUTH0_DOMAIN:"",REACT_APP_SERVER_URL:"https://server.dschool.vn",REACT_APP_LOGOUT_URL:"https://id.hocbaionha.com/oauth2/sessions/logout",REACT_APP_H5P_URL:"https://h5p.dschool.vn",REACT_APP_FIREBASE_API_KEY:"AIzaSyD1rFzhNHcbWql0L8g4dWMcdgn5KiZ3cv4",REACT_APP_FIREBASE_APP_ID:"1:666303282505:web:2daabfe2056b8bcf276e98",REACT_APP_FIREBASE_AUTH_DOMAIN:"hbon-sso.firebaseapp.com",REACT_APP_FIREBASE_DATABASE_URL:"https://hbon-sso.firebaseio.com",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"666303282505",REACT_APP_FIREBASE_PROJECT_ID:"hbon-sso",REACT_APP_FIREBASE_STORAGE_BUCKET:"hbon-sso.appspot.com",REACT_APP_GA_MEASUREMENT_ID:"G-6ED668BBJC"}).REACT_APP_DOMAIN_VIEWER+"/news_detail?content_id="+t+"&news_title="+encodeURIComponent(s.title),body:s.title,title:"Hbon news",content_type:"news"}},d()({method:"POST",url:"https://fcm.googleapis.com/fcm/send",body:p,headers:u,json:!0},(function(e,t,n){if(console.log(n),console.log(t),console.log(t.statusCode),console.log(t.request),e||200!==t.statusCode)return console.log(n),o(e||{statusCode:t.statusCode});o(null,n)}))));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=function(){var e=Object(s.a)(c.a.mark((function e(t){var o,n,a,s,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.firestore().collection("contents").doc(t).get();case 3:return o=e.sent,(n=o.data()).id=t,e.next=8,l.a.firestore().collection("contents").doc(t).collection("detail").doc("content").get();case 8:return a=e.sent,s=a.data(),console.log(s.content_url),e.next=13,fetch(s.content_url).then((function(e){return e.text()}));case 13:return r=e.sent,console.log(r),n.detail=r,e.abrupt("return",n);case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r,u,d,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("update contents"),n=t.id,a=" <news content-type='news'>"+t.detail+"</news>",delete t.detail,e.next=7,l.a.firestore().collection("contents").doc(n).update(t);case 7:if((s=l.a.storage().ref().child("public/contents/"+n).putString(a)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){s.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),l.a.firestore().collection("contents").doc(n).collection("detail").doc("content").set({file:"public/contents/"+n,content_url:e})}))})),"undefined"!=typeof o){e.next=11;break}return e.abrupt("return");case 11:t.cover,r={contentType:"image/jpeg"},u="public/images/content/"+t.id,d=l.a.storage().ref(),(p=d.child(u).put(o,r)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){p.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),t.cover=e,l.a.firestore().collection("contents").doc(n).update(t)}))})),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t,o){return e.apply(this,arguments)}}(),w=function(){var e=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r,u,d,p,f,g;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.schoolid)){e.next=28;break}return e.prev=2,a=" <news content-type='news'>"+t.detail+"</news>",delete t.detail,t.content_type="news",t.create_at=i.a.firestore.FieldValue.serverTimestamp(),e.next=9,l.a.firestore().collection("schools").doc(n).collection("contents").add(t);case 9:return s=e.sent,e.next=12,s.get();case 12:if(r=e.sent,console.log("done content:"+r.id),s.collection("detail").doc("content").set({data:a}),u=r.data(),"undefined"!=typeof o){e.next=18;break}return e.abrupt("return");case 18:d={contentType:"image/jpeg"},p="public/images/content/"+r.id,f=l.a.storage().ref(),(g=f.child(p).put(o,d)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){g.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),u.cover=e,l.a.firestore().collection("schools").doc(n).collection("contents").doc(r.id).update(u)}))})),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(2),console.log(e.t0);case 28:case"end":return e.stop()}}),e,null,[[2,25]])})));return function(t,o){return e.apply(this,arguments)}}(),R=function(){var e=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.firestore().collection("schools").doc(o).collection("contents").doc(t).get();case 3:return n=e.sent,(a=n.data()).id=t,e.next=8,l.a.firestore().collection("schools").doc(o).collection("contents").doc(t).collection("detail").doc("content").get();case 8:return s=e.sent,r=s.data(),a.detail=r.data,e.abrupt("return",a);case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,o){return e.apply(this,arguments)}}(),S=function(e,t){try{e.map((function(e){var o="public/images/content/"+e,n=l.a.storage().ref();n.child(o).getDownloadURL().then((function(e){n.child(o).delete()}),(function(e){console.log(e.code)})),l.a.firestore().collection("schools").doc(t).collection("contents").doc(e).collection("detail").doc("content").delete(),l.a.firestore().collection("schools").doc(t).collection("contents").doc(e).delete()}))}catch(o){console.log(o)}},P=function(){var e=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r,u,d,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.schoolid,console.log("update contents"),a=t.id,s=" <news content-type='news'>"+t.detail+"</news>",delete t.detail,e.next=8,l.a.firestore().collection("schools").doc(n).collection("contents").doc(a).update(t);case 8:return e.next=10,l.a.firestore().collection("schools").doc(n).collection("contents").doc(a).collection("detail").doc("content").update({data:s});case 10:if("undefined"!=typeof o){e.next=12;break}return e.abrupt("return");case 12:t.cover,r={contentType:"image/jpeg"},u="public/images/content/"+t.id,d=l.a.storage().ref(),(p=d.child(u).put(o,r)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){p.snapshot.ref.getDownloadURL().then((function(e){console.log("File available at",e),t.cover=e,l.a.firestore().collection("schools").doc(n).collection("contents").doc(a).update(t)}))})),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,o){return e.apply(this,arguments)}}(),U=function(){var e=Object(s.a)(c.a.mark((function e(t,o){var n,a,s,r,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Object(p.a)(),"undefined"!=typeof t){e.next=4;break}return e.abrupt("return",o(null));case 4:a={contentType:"image/jpeg"},s="public/images/content/detail/"+n,r=l.a.storage().ref(),(u=r.child(s).put(t,a)).on(i.a.storage.TaskEvent.STATE_CHANGED,(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload cover is "+t+"% done"),e.state){case i.a.storage.TaskState.PAUSED:console.log("Upload cover is paused");break;case i.a.storage.TaskState.RUNNING:console.log("Upload cover is running")}}),(function(e){switch(e.code){case"storage/unauthorized":console.log("unauthorized");break;case"storage/canceled":console.log("cancel");break;case"storage/unknown":console.log("unkonwn")}}),(function(){u.snapshot.ref.getDownloadURL().then((function(e){return console.log("File available at",e),o(e)}))})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,o){return e.apply(this,arguments)}}(),m=function(){var e=Object(s.a)(c.a.mark((function e(t){var o,n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),o=[],n=l.a.firestore().collection("contents").doc(t).collection("embedded_submissions"),e.next=5,n.get();case 5:return e.sent.forEach(function(){var e=Object(s.a)(c.a.mark((function e(n){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.data(),r=l.a.firestore().collection("contents").doc(t).collection("embedded_submissions").doc(n.id).collection("quizzes_submissions"),e.next=4,r.get();case 4:e.sent.forEach(function(){var e=Object(s.a)(c.a.mark((function e(t){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=t.data().result,a["logs-"+t.id]=o.toString(),a["results-"+t.id]=o.filter((function(e){return!0===e})).length;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.push(a),console.log(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,l.a.firestore().collection("contents").doc(t).get();case 9:a=e.sent,r=a.data(),setTimeout((function(){var e=r.title,t={Sheets:{data:f.utils.json_to_sheet(o)},SheetNames:["data"]},n=f.write(t,{bookType:"xlsx",type:"array"}),c=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(c,e+".xlsx")}),3e4);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},1393:function(e,t){},1394:function(e,t){},1395:function(e,t){},1660:function(e,t){},1662:function(e,t){},1663:function(e,t){}}]);
//# sourceMappingURL=11.d4fb09cc.chunk.js.map