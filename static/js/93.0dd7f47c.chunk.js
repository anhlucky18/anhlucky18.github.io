(this["webpackJsonp@devias-io/material-kit-pro-react"]=this["webpackJsonp@devias-io/material-kit-pro-react"]||[]).push([[93],{1258:function(e,t,n){"use strict";var r=n(0);t.a=function(){var e=Object(r.useRef)(!0);return Object(r.useEffect)((function(){return function(){e.current=!1}}),[]),e}},1671:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(9),a=n.n(r),c=n(14);function s(e){return o.apply(this,arguments)}function o(){return(o=Object(c.a)(a.a.mark((function e(t){var n,r,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n="",c=(r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,s=0;s<t;s++)n+=r.charAt(Math.floor(Math.random()*c));return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){return i.apply(this,arguments)}function i(){return(i=Object(c.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n="","0123456789",r="0123456789".length,c=0;c<t;c++)n+="0123456789".charAt(Math.floor(Math.random()*r));return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},1886:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return f}));var r=n(24),a=n(9),c=n.n(a),s=n(14),o=(n(1286),n(53)),u=n(184),i=n.n(u),l=n(1671),p=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.a)(6);case 3:return n=e.sent,e.next=6,o.a.firestore().collection("classes").doc(n);case 6:if(r=e.sent,!r.get().exists){e.next=12;break}return e.abrupt("return","existed");case 12:return e.next=14,o.a.firestore().collection("classes").doc(n).set(t);case 14:return console.log("add class success"),e.next=17,o.a.firestore().collection("schools").doc(t.school_id).update({classes:i.a.firestore.FieldValue.arrayUnion(r)});case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.firestore().collection("classes").doc(t).get();case 3:return n=e.sent,(r=n.data()).id=t,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(t),n=t.id,e.next=5,o.a.firestore().collection("classes").doc(n).update(t);case 5:return r=e.sent,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.firestore().collection("classes").where("school_id","==",t).get();case 3:if(!(n=e.sent).docs){e.next=8;break}return a=n.docs.map((function(e){return Object(r.a)({id:e.id},e.data())})),console.log(a),e.abrupt("return",a);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},1938:function(e,t,n){"use strict";n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"c",(function(){return x}));var r=n(9),a=n.n(r),c=n(24),s=n(14),o=n(1286),u=n(184),i=n.n(u),l=n(53),p=function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.firestore().collection("students").where("school_id","==",t).where("status","==",0).get();case 3:if(n=e.sent,console.log(n.empty),console.log(n.size),!n.docs){e.next=9;break}return r=n.docs.map((function(e){return Object(c.a)({id:e.id},e.data())})),e.abrupt("return",r);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.email,e.next=4,l.a.firestore().collection("users").where("username","==",n).get();case 4:if(!(c=e.sent).docs){e.next=8;break}if(!(c.docs.length>0)){e.next=8;break}return e.abrupt("return","username_exited");case 8:return e.next=10,l.a.firestore().collection("users").where("email","==",r).get();case 10:if(!(s=e.sent).docs){e.next=14;break}if(!(s.docs.length>0)){e.next=14;break}return e.abrupt("return","email_exited");case 14:return e.abrupt("return","success");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r,c,s,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(n);case 3:if(r=e.sent,console.log("error:",r),"success"==r){e.next=7;break}return e.abrupt("return",r);case 7:return c={type:"student",action:"create",status:0,executer:t,data:n},console.log(c),e.next=11,l.a.firestore().collection("commands").add(c);case 11:return s=e.sent,e.next=14,s.get();case 14:return e.next=16,e.sent.id;case 16:return o=e.sent,console.log("add command success",o),e.abrupt("return","success");case 21:e.prev=21,e.t0=e.catch(0),console.log(e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.birthdate._isAMomentObject&&(n.birthdate=i.a.firestore.Timestamp.fromDate(n.birthdate.toDate())),n.products=[],console.log(n.birthdate),r={type:"student",action:"add",status:0,executer:t,data:n},console.log(r),e.next=8,l.a.firestore().collection("commands").add(r);case 8:e.sent,console.log("add command success"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r,c,s,u,i,p,d,m,f,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.firestore().collection("students").doc(t).get();case 3:if(n=e.sent,(r=n.data()).id=t,c=[],"undefined"!==typeof r.products){e.next=10;break}return r.products=c,e.abrupt("return",r);case 10:s=!0,u=!1,e.prev=12,p=Object(o.a)(r.products);case 14:return e.next=16,p.next();case 16:return d=e.sent,s=d.done,e.next=20,d.value;case 20:if(m=e.sent,s){e.next=30;break}return f=m,e.next=25,f.get();case 25:h=e.sent,c.push(h.id);case 27:s=!0,e.next=14;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(12),u=!0,i=e.t0;case 36:if(e.prev=36,e.prev=37,s||null==p.return){e.next=41;break}return e.next=41,p.return();case 41:if(e.prev=41,!u){e.next=44;break}throw i;case 44:return e.finish(41);case 45:return e.finish(36);case 46:return r.products=c,e.abrupt("return",r);case 50:e.prev=50,e.t1=e.catch(0),console.log(e.t1);case 53:case"end":return e.stop()}}),e,null,[[0,50],[12,32,36,46],[37,,41,45]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.birthdate._isAMomentObject&&(t.birthdate=i.a.firestore.Timestamp.fromDate(t.birthdate.toDate())),e.prev=1,n=t.id,e.next=5,l.a.firestore().collection("students").doc(n).update(t);case 5:return r=e.sent,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(s.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l.a.firestore().collection("students").where("school_id","==",t).where("status","==",0).where("products",">",[]).get();case 3:if(!(n=e.sent).docs){e.next=7;break}return r=n.docs.map((function(e){return Object(c.a)({id:e.id},e.data())})),e.abrupt("return",r);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(s.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={type:"enrole_student",action:"add",status:0,executer:t,data:n},console.log(r),e.next=5,l.a.firestore().collection("commands").add(r);case 5:console.log("add command success"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()},2773:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(380),s=n(1180),o=n(374),u=n(390),i=n(9),l=n.n(i),p=n(14),d=n(17),m=n(28),f=n(1286),h=n(2),b=n(1363),v=n(1355),x=n(62),g=n(1174),k=n(1176),j=n(1188),O=n(1161),w=n(1151),E=n(2411),y=n(188),_=n(1671),S=n(1258),N=n(55),T=n(1938),B=n(1886),C=n(25),M=Object(c.a)((function(){return{root:{}}})),D=[{id:"male",name:"Nam"},{id:"female",name:"N\u1eef"}],W=function(e){var t=e.className,n=Object(m.a)(e,["className"]),c=Object(C.a)().user,s=Object(N.g)(),u=localStorage.getItem("schoolid"),i=M(),W=Object(r.useState)(""),A=Object(d.a)(W,2),F=A[0],P=A[1],V=Object(r.useState)([]),Y=Object(d.a)(V,2),q=Y[0],z=Y[1],H=Object(S.a)(),I=Object(r.useCallback)(Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(B.c)(u);case 3:t=e.sent,console.log(t),H.current&&(z(t),console.log("class loaded"),P(t[0].id)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),[H]);Object(r.useEffect)((function(){I()}),[I]);var J=function(e){e.persist(),console.log(e.target.value),P(e.target.value)};Object(x.b)().enqueueSnackbar;return a.a.createElement(v.a,{initialValues:{name:"",birthdate:new Date,parent_name:"",parent_phone:"",submit:null},validationSchema:b.e().shape({name:b.g().max(75).required("B\u1eaft bu\u1ed9c nh\u1eadp t\xean"),birthdate:b.c(),parent_name:b.g().max(75),parent_phone:b.g().max(15)}),onSubmit:function(){var e=Object(p.a)(l.a.mark((function e(t,n){var r,a,o,i,p,d,m,h,b,v,x,g;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.resetForm,r=n.setErrors,a=n.setStatus,o=n.setSubmitting,e.prev=1,t.school_id=u,i={},console.log(F),i.id=F,p=!0,d=!1,e.prev=8,h=Object(f.a)(q);case 10:return e.next=12,h.next();case 12:return b=e.sent,p=b.done,e.next=16,b.value;case 16:if(v=e.sent,p){e.next=23;break}(x=v).id==i.id&&(i.name=x.name);case 20:p=!0,e.next=10;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(8),d=!0,m=e.t0;case 29:if(e.prev=29,e.prev=30,p||null==h.return){e.next=34;break}return e.next=34,h.return();case 34:if(e.prev=34,!d){e.next=37;break}throw m;case 37:return e.finish(34);case 38:return e.finish(29);case 39:return t.class=i,t.displayName=t.name,g=t.name.split(" "),console.log(g.length),t.firstname=g[0],t.lastname=g[g.length-1],e.next=47,Object(_.b)(4);case 47:return e.t1=e.sent,t.password="abcd"+e.t1,t.status=0,console.log(t),Object(T.a)(c,t),e.next=54,Object(y.a)(500);case 54:s.push("/school/management/students"),e.next=63;break;case 57:e.prev=57,e.t2=e.catch(1),console.error(e.t2),a({success:!1}),r({submit:e.t2.message}),o(!1);case 63:case"end":return e.stop()}}),e,null,[[1,57],[8,25,29,39],[30,,34,38]])})));return function(t,n){return e.apply(this,arguments)}}()},(function(e){var r=e.errors,c=e.handleBlur,s=e.handleChange,u=e.handleSubmit,l=e.isSubmitting,p=e.setFieldValue,d=e.setFieldTouched,m=e.touched,f=e.values;return a.a.createElement("form",Object.assign({className:Object(h.default)(i.root,t),onSubmit:u},n),a.a.createElement(g.a,null,a.a.createElement(k.a,null,a.a.createElement(j.a,{container:!0,spacing:3},a.a.createElement(j.a,{item:!0,md:6,xs:12},a.a.createElement(O.a,{error:Boolean(m.name&&r.name),fullWidth:!0,helperText:m.name&&r.name,label:"T\xean h\u1ecdc sinh",name:"name",onBlur:c,onChange:s,required:!0,value:f.name,variant:"outlined"})),a.a.createElement(j.a,{item:!0,md:6,xs:12},a.a.createElement(O.a,{label:"L\u1edbp",name:"sclass",onChange:J,select:!0,SelectProps:{native:!0},variant:"outlined",value:F},q.map((function(e){return a.a.createElement("option",{key:e.id,value:e.id},e.name)})))),a.a.createElement(j.a,{item:!0,md:6,xs:12},a.a.createElement(O.a,{fullWidth:!0,label:"Gi\u1edbi t\xednh",name:"gender",onChange:s,select:!0,SelectProps:{native:!0},value:f.gender,variant:"outlined"},D.map((function(e){return a.a.createElement("option",{key:e.id,value:e.id},e.name)})))),a.a.createElement(j.a,{item:!0,md:6,xs:12},a.a.createElement(E.a,{className:i.datePicker,label:"Ng\xe0y sinh (ng\xe0y/th\xe1ng/n\u0103m)",format:"DD/MM/YYYY",name:"birthdate",inputVariant:"outlined",value:f.birthdate,onBlur:function(){return d("birthdate")},onClose:function(){return d("birthdate")},onAccept:function(){return d("birthdate")},onChange:function(e){return p("birthdate",e)}})),a.a.createElement(j.a,{item:!0,md:6,xs:12},a.a.createElement(O.a,{error:Boolean(m.parent_name&&r.parent_name),fullWidth:!0,helperText:m.parent_name&&r.parent_name,label:"T\xean ph\u1ee5 huynh",name:"parent_name",onBlur:c,onChange:s,value:f.parent_name,variant:"outlined"})),a.a.createElement(j.a,{item:!0,md:6,xs:12},a.a.createElement(O.a,{error:Boolean(m.parent_phone&&r.parent_phone),fullWidth:!0,helperText:m.parent_phone&&r.parent_phone,label:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i ph\u1ee5 huynh",name:"parent_phone",onBlur:c,onChange:s,value:f.parent_phone,variant:"outlined"})),a.a.createElement(j.a,{item:!0})),a.a.createElement(o.a,{mt:2},a.a.createElement(w.a,{variant:"contained",color:"secondary",type:"submit",disabled:l},"L\u01b0u")))))}))},A=n(8),F=n(1233),P=n(1191),V=n(84),Y=n(1278),q=n.n(Y),z=Object(c.a)((function(){return{root:{}}})),H=function(e){var t=e.className,n=Object(m.a)(e,["className"]),r=localStorage.getItem("schoolname"),c=z();return a.a.createElement("div",Object.assign({className:Object(h.default)(c.root,t)},n),a.a.createElement(F.a,{separator:a.a.createElement(q.a,{fontSize:"small"}),"aria-label":"breadcrumb"},a.a.createElement(P.a,{variant:"body1",color:"inherit",to:"/hbon/management/schools",component:A.a},"Tr\u01b0\u1eddng: ",r),a.a.createElement(P.a,{variant:"body1",color:"inherit",to:"/school/management/classes",component:A.a},"H\u1ecdc sinh")),a.a.createElement(V.a,{variant:"h3",color:"textPrimary"},"Th\xeam h\u1ecdc sinh"))},I=Object(c.a)((function(e){return{root:{backgroundColor:e.palette.background.dark,minHeight:"100%",paddingTop:e.spacing(3),paddingBottom:e.spacing(3)}}}));t.default=function(e){var t=I();return a.a.createElement(u.a,{className:t.root,title:"Th\xeam h\u1ecdc sinh"},a.a.createElement(s.a,{maxWidth:!1},a.a.createElement(H,null)),a.a.createElement(o.a,{mt:3},a.a.createElement(s.a,{maxWidth:"lg"},a.a.createElement(W,null))))}}}]);
//# sourceMappingURL=93.0dd7f47c.chunk.js.map